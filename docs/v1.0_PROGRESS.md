# v1.0 - Production Readiness

**Status:** Planning  
**Version Target:** 1.0.0  
**Date:** January 31, 2026

## Overview

Focus on making Glance Editor robust and production-ready through comprehensive testing, documentation, error handling, performance optimization, input validation, and security hardening.

**Out of Scope:**
- Multi-user conflict resolution
- Authentication (assume reverse proxy or LAN deployment)
- Metrics/telemetry collection
- Widget templates library

## Priority Areas

### 1. Documentation (High Priority)

#### README.md
- Quick start guide (docker-compose up)
- Screenshots/preview images
- Core features list
- Installation instructions (Docker, manual)
- Configuration reference
- Environment variables table
- Troubleshooting section
- Contributing guidelines
- License information

#### API Documentation
All REST endpoints with request/response formats:
- `GET /api/health`, `/api/healthz`, `/api/settings`
- `GET/PUT /api/config`, `/api/config/raw`
- `GET /api/includes/files`, `/api/includes/references`
- `GET/PUT/DELETE /api/includes/file/:path`
- WebSocket events: `config-changed`

#### Other Docs
- `CONTRIBUTING.md` - Dev setup, coding standards, PR process
- `CHANGELOG.md` - Version history from v0.5.0 → v1.0.0

### 2. Testing Coverage (Critical)

#### Backend Tests (Current: 24)
**configService.test.js:**
- Deactivated widgets handling
- Backup creation and restoration
- Concurrent writes handling
- File permission/disk space errors
- Corrupt YAML recovery
- Large config parsing (>1MB)
- Circular include detection
- Atomic write failures
- Config validation

**includeService.test.js (Create):**
- Directory listing
- Include directive parsing
- Path traversal attack prevention
- Main config protection
- Extension validation
- Non-existent file errors

**websocket.test.js (Create):**
- Connection/disconnect handling
- Message broadcast
- Reconnection with backoff

**api.test.js (Enhance):**
- Error responses (400, 404, 500)
- Request validation
- Concurrent requests
- CORS headers

#### Frontend Tests (Current: 201)
**New Test Files Needed:**
- `ExpandableTextEditor.test.tsx` - Expand/collapse, value changes
- `DraggableArrayInput.test.tsx` - Add/remove/reorder/drag
- Widget schema validation tests
- Undo/redo edge cases (branching, stack overflow)
- Widget copy/move operations
- Theme preset operations
- Environment variable detection patterns
- Monaco auto-completion and highlighting
- Custom API template editor
- Validation rules coverage
- Layout editor with many widgets

#### E2E Tests (Playwright)
- Load editor → Check dashboard
- Add page → Verify YAML → Preview
- Add widget → Config saves → Preview shows widget
- Edit widget → Preview updates
- Delete widget → Preview removes
- Open YAML editor → Make changes → Save
- Broken YAML → Error message → Fix → Save
- Create include file → Add directive → Valid
- Theme designer changes → Preview updates
- Undo/Redo operations
- Complex multi-page dashboard

### 3. Error Handling (High Priority)

#### File Operations
- Concurrent config saves (file locking)
- File permission errors with user-friendly messages
- Config corruption recovery from `.backup` files
- Disk space warnings
- Automatic backup cleanup (keep last 5)

#### WebSocket Stability
- Auto-reconnection with exponential backoff (2s → 60s max)
- Connection status in UI
- Queue changes during offline, replay on reconnect

#### Preview Reliability
- Error state when Glance iframe fails
- "Reload Preview" button
- Handle Glance unavailability
- Preview loading state

#### Debounce Optimization
- Review debounce values (save: 300ms, reload: 600ms)
- Progress indicator during saves
- Cancel pending save on rapid changes
- "Saving..." spinner, then "Saved" confirmation

### 4. User Feedback (High Priority)

#### Toast Notifications
- Save success/failure
- Error messages with retry option
- Warnings with dismiss action
- Position: Top-right, auto-dismiss after 5s

#### Loading States
- Spinners during save, fetch, preview refresh
- Skeleton screens for initial load

#### Confirmation Dialogs
- Before deleting pages
- Before deleting include files
- Before destructive operations

#### Keyboard Shortcuts
- `Ctrl+S` - Save config
- `Ctrl+Z` - Undo
- `Ctrl+Y` / `Ctrl+Shift+Z` - Redo
- `Ctrl+E` - Toggle Edit/Preview
- `Ctrl+,` - Open YAML editor
- `Ctrl+K` - Command palette
- `Escape` - Close active panel
- `Delete` - Delete selected widget

#### Context-Sensitive Help
- (?) button next to widget types
- Help modal with widget description, properties, examples
- Tooltips for complex inputs
- Go template function documentation

### 5. Code Editor Fixes (Critical)

- Fix "View in YAML" functionality
- Test bidirectional sync (visual ↔ code)
- Fix scroll-to-line from validation panel
- Fix include file switching glitches
- YAML syntax validation with error highlighting
- "Format YAML" button with Prettier
- Highlight tabs vs spaces
- Show line numbers
- Improved auto-completion for widget types and properties

### 6. Input Validation & Security (Critical)

#### Backend Validation
- Widget names (no special chars, length limits)
- Page slugs (valid URL chars, length limits)
- YAML size limits (<5MB)
- File upload limits (<1MB for includes)
- URL validation with regex
- HSL color range validation
- Duration format validation

#### File Security
- Enforce path normalization
- Reject absolute paths
- Verify paths within config directory
- Protect main config from include API
- Only allow `.yml`/`.yaml` extensions
- Validate YAML syntax before saving
- Detect circular includes

#### Sanitization
- Widget titles (prevent XSS)
- User-defined CSS classes
- YAML comment escaping

### 7. Technical Debt (Medium Priority)

#### TypeScript
- Fix all `any` types
- Enable `noImplicitAny`, `strictNullChecks`

#### Code Organization
Split `App.tsx` (39KB) into:
- `EditorLayout.tsx` - Main layout structure
- `Toolbar.tsx` - Header actions
- `SidebarLeft.tsx` - Pages and theme
- `SidebarRight.tsx` - Widgets and env vars

#### Performance
- Lazy load Monaco editor
- React.memo for expensive components
- Virtualize large lists
- Request debouncing on API calls

#### Bundle Analysis
- Add `rollup-plugin-visualizer`
- Code splitting by route/feature
- Set bundle size limits in CI

### 8. Deployment

#### Health Checks
- Include config file existence
- Check Glance connectivity
- Add `/api/ready` endpoint
- Include config version in response

#### Reverse Proxy Support
- Handle `X-Forwarded-*` headers
- Support `BASE_URL` environment variable
- Document reverse proxy configuration

#### Docker
- Non-root user
- Read-only filesystem where possible
- Proper signal handling (SIGTERM)
- Resource limits

## Success Criteria

| Criterion | Target |
|-----------|--------|
| Documentation | Complete README, API docs, contributing guide |
| Backend tests | >50 tests |
| Frontend tests | >300 tests |
| E2E tests | >15 tests |
| Code editor | Fully functional bidirectional sync |
| Bundle size | <500KB |
| Lighthouse score | >90 |
| Security | All input validation implemented |
| UX | Keyboard shortcuts, toasts, help system |

## Timeline

| Week | Focus |
|------|-------|
| 1 | Documentation + Backend tests + Code editor fixes |
| 2 | Frontend tests + E2E + Error handling |
| 3 | UX improvements + Validation + Security |
| 4 | Performance + Technical debt + Beta release |

## Branch

Create branch `phase-1.0-readiness` for implementation.
